<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CCRI Cyberknights Communications</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .main-content {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            transition: transform 0.3s ease;
        }

        .card:hover {
            transform: translateY(-2px);
        }

        .card h2 {
            color: #4a5568;
            margin-bottom: 20px;
            font-size: 1.5rem;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }

        /* Spreadsheet Styles */
        .spreadsheet-container {
            overflow-x: auto;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            background: white;
        }

        .spreadsheet-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
        }

        .spreadsheet-table th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 12px;
            text-align: left;
            font-weight: 600;
            border: 1px solid #4a5568;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .spreadsheet-table td {
            padding: 0;
            border: 1px solid #e2e8f0;
            position: relative;
        }

        .spreadsheet-table input {
            width: 100%;
            padding: 12px;
            border: none;
            outline: none;
            background: transparent;
            font-size: 14px;
            font-family: inherit;
            transition: background-color 0.2s ease;
        }

        .spreadsheet-table input:focus {
            background-color: #f7fafc;
            box-shadow: inset 0 0 0 2px #667eea;
        }

        .spreadsheet-table input:not(:placeholder-shown) {
            background-color: #f7fafc;
        }

        .row-number {
            background: #f7fafc;
            color: #718096;
            font-weight: 600;
            text-align: center;
            width: 50px;
            padding: 12px 8px;
            border-right: 2px solid #e2e8f0;
        }

        .actions-column {
            background: #f7fafc;
            width: 80px;
            text-align: center;
            padding: 8px;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
            transition: all 0.3s ease;
            margin: 2px;
        }

        .btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 3px 10px rgba(102, 126, 234, 0.4);
        }

        .btn-danger {
            background: #e53e3e;
        }

        .btn-success {
            background: #48bb78;
        }

        .btn-secondary {
            background: #718096;
        }

        .btn-small {
            padding: 4px 8px;
            font-size: 11px;
        }

        /* Toolbar */
        .toolbar {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            align-items: center;
        }

        .toolbar .btn {
            margin: 0;
        }

        /* Template Panel */
        .template-panel {
            max-height: 600px;
            overflow-y: auto;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #4a5568;
        }

        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }

        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .message-preview {
            background: #f7fafc;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            white-space: pre-wrap;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
        }

        .stats {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
            padding: 15px;
            background: #f7fafc;
            border-radius: 8px;
        }

        .stat-item {
            text-align: center;
        }

        .stat-number {
            font-size: 1.5rem;
            font-weight: bold;
            color: #667eea;
        }

        .stat-label {
            font-size: 0.9rem;
            color: #718096;
        }

        .hidden {
            display: none;
        }

        .alert {
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .alert-success {
            background-color: #c6f6d5;
            color: #22543d;
            border: 1px solid #9ae6b4;
        }

        .alert-error {
            background-color: #fed7d7;
            color: #742a2a;
            border: 1px solid #feb2b2;
        }

        .file-upload {
            border: 2px dashed #cbd5e0;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            transition: border-color 0.3s ease;
            cursor: pointer;
            margin-bottom: 15px;
        }

        .file-upload:hover {
            border-color: #667eea;
        }

        .file-upload.dragover {
            border-color: #667eea;
            background-color: #f7fafc;
        }

        @media (max-width: 1024px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .toolbar {
                flex-direction: column;
                align-items: stretch;
            }
            
            .stats {
                flex-direction: column;
                gap: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üõ°Ô∏è CCRI Cyberknights Communications</h1>
            <p>Spreadsheet-style contact management and message generation</p>
        </div>

        <div id="alert-container"></div>

        <div class="main-content">
            <!-- Contact Spreadsheet -->
            <div class="card">
                <h2>üìä Contact Spreadsheet</h2>
                
                <div class="stats">
                    <div class="stat-item">
                        <div class="stat-number" id="totalContacts">0</div>
                        <div class="stat-label">Total Contacts</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number" id="filledRows">0</div>
                        <div class="stat-label">Filled Rows</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number" id="emptyRows">1</div>
                        <div class="stat-label">Empty Rows</div>
                    </div>
                </div>

                <div class="toolbar">
                    <button class="btn" onclick="addRow()">Add Row</button>
                    <button class="btn btn-secondary" onclick="clearAll()">Clear All</button>
                    <button class="btn btn-success" onclick="exportData()">Export CSV</button>
                    <button class="btn btn-secondary" onclick="importData()">Import CSV</button>
                    <input type="file" id="fileInput" accept=".csv" style="display: none;" onchange="handleFileImport(event)">
                </div>

                <div class="spreadsheet-container">
                    <table class="spreadsheet-table" id="contactsTable">
                        <thead>
                            <tr>
                                <th class="row-number">#</th>
                                <th>Name</th>
                                <th>Email</th>
                                <th class="actions-column">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="contactsTableBody">
                            <!-- Rows will be generated by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Message Templates -->
            <div class="card">
                <h2>‚úâÔ∏è Message Templates</h2>
                
                <div class="template-panel">
                    <div class="form-group">
                        <label for="templateSelect">Select Template:</label>
                        <select id="templateSelect" onchange="loadTemplate()">
                            <option value="">Choose a template...</option>
                            <option value="webform">New Member Welcome (Web Form)</option>
                            <option value="email-outreach">New Member Welcome (Email Outreach)</option>
                            <option value="club-fair">Club Fair Follow-up</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="messageTemplate">Message Template:</label>
                        <textarea id="messageTemplate" rows="8" placeholder="Select a template or write your own message..."></textarea>
                    </div>
                    
                    <button class="btn" onclick="generateMessages()">Generate Messages</button>
                    <button class="btn btn-secondary" onclick="clearTemplate()">Clear Template</button>
                    
                    <div id="generatedMessages" class="hidden">
                        <h3 style="margin-top: 20px; margin-bottom: 15px;">Generated Messages:</h3>
                        <div id="messagesContainer"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Quick Actions -->
        <div class="card">
            <h2>‚ö° Quick Actions</h2>
            <div class="toolbar">
                <button class="btn" onclick="saveToLocalStorage()">Save to Browser</button>
                <button class="btn btn-secondary" onclick="loadFromLocalStorage()">Load from Browser</button>
                <button class="btn btn-success" onclick="openGitHub()">View on GitHub</button>
                <button class="btn btn-secondary" onclick="downloadTemplate()">Download CSV Template</button>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let contacts = [];
        let nextRowId = 1;
        let currentTemplate = '';

        // Template definitions
        const templates = {
            'webform': `Subject: Welcome to CCRI Cyberknights! üõ°Ô∏è

Hi {{name}},

Welcome to the CCRI Cyberknights! We're excited to have you join our cybersecurity community.

## Next Steps

1. **Join our Discord server**: [Discord Link]
   - This is where we coordinate meetings, share resources, and chat about cybersecurity topics
   - Please introduce yourself in the #introductions channel

2. **Check out our upcoming events**: We'll be posting meeting times and special events in Discord

3. **Get involved**: Feel free to ask questions, share interesting articles, or suggest topics for future meetings

## Important Links

- **Discord Server**: [Discord Link]
- **Club Website**: [Website URL]
- **Meeting Schedule**: [Meeting Info]

If you have any questions, don't hesitate to reach out to any of our officers or post in Discord.

Looking forward to seeing you at our next meeting!

Best regards,
The CCRI Cyberknights Leadership Team`,

            'email-outreach': `Subject: Welcome to CCRI Cyberknights! üõ°Ô∏è

Hi {{name}},

Thank you for your interest in the CCRI Cyberknights! We're excited to have you join our cybersecurity community.

## Getting Started

Since you provided your email directly, here are two ways to get involved:

### Option 1: Join our Discord (Recommended)
- **Discord Server**: [Discord Link]
- This is our primary communication hub for meetings, resources, and discussions
- Please introduce yourself in the #introductions channel

### Option 2: Fill out our official membership form
- **Web Form**: [Web Form Link]
- This helps us keep track of all members and send important updates

## What to Expect

- **Regular meetings**: We meet [schedule] to discuss cybersecurity topics, practice skills, and plan activities
- **Hands-on learning**: CTF competitions, workshops, and guest speakers
- **Networking**: Connect with fellow cybersecurity enthusiasts and industry professionals
- **Resources**: Access to study materials, tools, and career guidance

## Important Links

- **Discord Server**: [Discord Link]
- **Membership Form**: [Web Form Link]
- **Club Website**: [Website URL]
- **Meeting Schedule**: [Meeting Info]

## Questions?

Feel free to reach out to any of our officers or post in Discord. We're here to help you get the most out of your Cyberknights experience!

Welcome aboard!

Best regards,
The CCRI Cyberknights Leadership Team`,

            'club-fair': `Subject: Thanks for your interest in CCRI Cyberknights! üõ°Ô∏è

Hi {{name}},

Thank you for stopping by our table at the club fair! We're excited about your interest in the CCRI Cyberknights cybersecurity club.

## What We're About

The CCRI Cyberknights is a student organization focused on cybersecurity education, hands-on learning, and professional development. We offer:

- **CTF Competitions**: Test your skills in Capture The Flag challenges
- **Workshops**: Learn about ethical hacking, network security, and more
- **Guest Speakers**: Industry professionals share insights and career advice
- **Networking**: Connect with fellow cybersecurity enthusiasts

## Get Involved

1. **Join our Discord**: [Discord Link]
2. **Fill out our membership form**: [Web Form Link]
3. **Attend our next meeting**: [Meeting Info]

## Questions?

Feel free to reach out if you have any questions about the club or cybersecurity in general. We'd love to hear from you!

Best regards,
The CCRI Cyberknights Leadership Team`
        };

        // Utility functions
        function showAlert(message, type = 'success') {
            const alertContainer = document.getElementById('alert-container');
            const alert = document.createElement('div');
            alert.className = `alert alert-${type}`;
            alert.textContent = message;
            alertContainer.appendChild(alert);
            
            setTimeout(() => {
                alert.remove();
            }, 5000);
        }

        function updateStats() {
            const totalContacts = contacts.length;
            const filledRows = contacts.filter(contact => contact.name.trim() && contact.email.trim()).length;
            const emptyRows = Math.max(1, totalContacts - filledRows + 1);
            
            document.getElementById('totalContacts').textContent = totalContacts;
            document.getElementById('filledRows').textContent = filledRows;
            document.getElementById('emptyRows').textContent = emptyRows;
        }

        function createRow(rowId, name = '', email = '') {
            const row = document.createElement('tr');
            row.id = `row-${rowId}`;
            row.innerHTML = `
                <td class="row-number">${rowId}</td>
                <td>
                    <input type="text" 
                           placeholder="Enter name..." 
                           value="${name}"
                           oninput="handleInput(${rowId}, 'name', this.value)"
                           onkeydown="handleKeyDown(event, ${rowId})">
                </td>
                <td>
                    <input type="email" 
                           placeholder="Enter email..." 
                           value="${email}"
                           oninput="handleInput(${rowId}, 'email', this.value)"
                           onkeydown="handleKeyDown(event, ${rowId})">
                </td>
                <td class="actions-column">
                    <button class="btn btn-danger btn-small" onclick="removeRow(${rowId})" title="Delete row">√ó</button>
                </td>
            `;
            return row;
        }

        function addRow(name = '', email = '') {
            const rowId = nextRowId++;
            const row = createRow(rowId, name, email);
            document.getElementById('contactsTableBody').appendChild(row);
            
            // Add to contacts array
            contacts.push({ id: rowId, name, email });
            updateStats();
            
            // Focus on the name input of the new row
            const nameInput = row.querySelector('input[type="text"]');
            nameInput.focus();
        }

        function removeRow(rowId) {
            // Remove from DOM
            const row = document.getElementById(`row-${rowId}`);
            if (row) {
                row.remove();
            }
            
            // Remove from contacts array
            contacts = contacts.filter(contact => contact.id !== rowId);
            updateStats();
        }

        function handleInput(rowId, field, value) {
            const contact = contacts.find(c => c.id === rowId);
            if (contact) {
                contact[field] = value;
            }
            
            // Check if this is the last row and user is typing
            const rows = document.querySelectorAll('#contactsTableBody tr');
            const lastRow = rows[rows.length - 1];
            const currentRow = document.getElementById(`row-${rowId}`);
            
            if (currentRow === lastRow && value.trim()) {
                // Add a new empty row
                addRow();
            }
            
            updateStats();
        }

        function handleKeyDown(event, rowId) {
            // Handle Enter key to move to next field
            if (event.key === 'Enter') {
                event.preventDefault();
                const currentInput = event.target;
                const row = document.getElementById(`row-${rowId}`);
                const inputs = row.querySelectorAll('input');
                const currentIndex = Array.from(inputs).indexOf(currentInput);
                
                if (currentIndex < inputs.length - 1) {
                    inputs[currentIndex + 1].focus();
                } else {
                    // If we're on the last input of the row, add a new row and focus on its first input
                    addRow();
                }
            }
            
            // Handle Delete key on empty inputs
            if (event.key === 'Delete' || event.key === 'Backspace') {
                const currentInput = event.target;
                if (!currentInput.value && contacts.length > 1) {
                    // Only allow deletion if there's more than one row
                    removeRow(rowId);
                }
            }
        }

        function clearAll() {
            if (confirm('Are you sure you want to clear all contacts?')) {
                contacts = [];
                nextRowId = 1;
                document.getElementById('contactsTableBody').innerHTML = '';
                addRow(); // Add one empty row
                updateStats();
                showAlert('All contacts cleared');
            }
        }

        function exportData() {
            const validContacts = contacts.filter(contact => contact.name.trim() && contact.email.trim());
            
            if (validContacts.length === 0) {
                showAlert('No contacts to export', 'error');
                return;
            }
            
            const csvContent = 'Name,Email\n' + 
                validContacts.map(contact => `"${contact.name}","${contact.email}"`).join('\n');
            
            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'cyberknights_contacts.csv';
            a.click();
            window.URL.revokeObjectURL(url);
            
            showAlert(`Exported ${validContacts.length} contacts to CSV`);
        }

        function importData() {
            document.getElementById('fileInput').click();
        }

        function handleFileImport(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const csv = e.target.result;
                const lines = csv.split('\n');
                
                if (lines.length < 2) {
                    showAlert('Invalid CSV file', 'error');
                    return;
                }
                
                // Clear existing data
                clearAll();
                
                let importedCount = 0;
                for (let i = 1; i < lines.length; i++) {
                    const line = lines[i].trim();
                    if (!line) continue;
                    
                    // Simple CSV parsing (handles quoted values)
                    const values = line.match(/(".*?"|[^",\s]+)(?=\s*,|\s*$)/g);
                    if (values && values.length >= 2) {
                        const name = values[0].replace(/"/g, '').trim();
                        const email = values[1].replace(/"/g, '').trim();
                        
                        if (name && email && isValidEmail(email)) {
                            addRow(name, email);
                            importedCount++;
                        }
                    }
                }
                
                showAlert(`Imported ${importedCount} contacts from CSV`);
            };
            reader.readAsText(file);
        }

        function isValidEmail(email) {
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return emailRegex.test(email);
        }

        function loadTemplate() {
            const templateSelect = document.getElementById('templateSelect');
            const messageTemplate = document.getElementById('messageTemplate');
            
            if (templateSelect.value && templates[templateSelect.value]) {
                messageTemplate.value = templates[templateSelect.value];
                currentTemplate = templateSelect.value;
            }
        }

        function generateMessages() {
            const messageTemplate = document.getElementById('messageTemplate').value;
            
            if (!messageTemplate.trim()) {
                showAlert('Please enter a message template', 'error');
                return;
            }
            
            const validContacts = contacts.filter(contact => contact.name.trim() && contact.email.trim());
            
            if (validContacts.length === 0) {
                showAlert('Please add at least one contact with name and email', 'error');
                return;
            }
            
            const messagesContainer = document.getElementById('messagesContainer');
            const generatedMessages = document.getElementById('generatedMessages');
            
            messagesContainer.innerHTML = validContacts.map(contact => {
                const personalizedMessage = messageTemplate.replace(/\{\{name\}\}/g, contact.name);
                return `
                    <div class="message-preview">
                        <strong>To: ${contact.email}</strong>
                        <br><br>
                        ${personalizedMessage}
                        <br><br>
                        <button class="btn btn-small" onclick="copyToClipboard('${personalizedMessage.replace(/'/g, "\\'")}')">Copy Message</button>
                    </div>
                `;
            }).join('');
            
            generatedMessages.classList.remove('hidden');
            showAlert(`Generated ${validContacts.length} personalized messages!`);
        }

        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                showAlert('Message copied to clipboard!');
            }).catch(err => {
                showAlert('Failed to copy message', 'error');
            });
        }

        function clearTemplate() {
            document.getElementById('messageTemplate').value = '';
            document.getElementById('templateSelect').value = '';
            document.getElementById('generatedMessages').classList.add('hidden');
        }

        function saveToLocalStorage() {
            const data = {
                contacts: contacts,
                nextRowId: nextRowId
            };
            localStorage.setItem('cyberknights_contacts', JSON.stringify(data));
            showAlert('Data saved to browser storage');
        }

        function loadFromLocalStorage() {
            const saved = localStorage.getItem('cyberknights_contacts');
            if (!saved) {
                showAlert('No saved data found', 'error');
                return;
            }
            
            try {
                const data = JSON.parse(saved);
                
                // Clear existing data
                clearAll();
                
                // Load saved data
                contacts = data.contacts || [];
                nextRowId = data.nextRowId || 1;
                
                // Rebuild table
                document.getElementById('contactsTableBody').innerHTML = '';
                contacts.forEach(contact => {
                    const row = createRow(contact.id, contact.name, contact.email);
                    document.getElementById('contactsTableBody').appendChild(row);
                });
                
                // Add one empty row if needed
                if (contacts.length === 0) {
                    addRow();
                }
                
                updateStats();
                showAlert('Data loaded from browser storage');
            } catch (error) {
                showAlert('Error loading saved data', 'error');
            }
        }

        function downloadTemplate() {
            const csvContent = 'Name,Email\n"John Doe","john.doe@example.com"\n"Jane Smith","jane.smith@example.com"';
            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'contacts_template.csv';
            a.click();
            window.URL.revokeObjectURL(url);
            showAlert('CSV template downloaded!');
        }

        function openGitHub() {
            window.open('https://github.com/CCRI-Cyberknights/comms', '_blank');
        }

        // Initialize the application
        function init() {
            // Add initial empty row
            addRow();
            
            // Try to load from localStorage on startup
            loadFromLocalStorage();
        }

        // Start the application
        init();
    </script>
</body>
</html>